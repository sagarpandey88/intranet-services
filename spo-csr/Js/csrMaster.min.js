function loadScript(n,t){var r=document.getElementsByTagName("head")[0],i=document.createElement("script"),u=!1;i.src=n;i.onload=i.onreadystatechange=function(){u||this.readyState&&this.readyState!=="loaded"&&this.readyState!=="complete"||(u=!0,t(this.src),i.onload=i.onreadystatechange=null,r.removeChild(i))};r.appendChild(i)}function loadCss(n,t){var r=n,u,i;document.getElementById(r)||(u=document.getElementsByTagName("head")[0],i=document.createElement("link"),i.id=r,i.rel="stylesheet",i.type="text/css",i.href=t,i.media="all",u.appendChild(i))}function blankCallback(n){_csrAppContext.DebugMode&&console.log(n+" has been loaded..")}function AddSiteUserCustomAction(n,t,i,r,u){var e=new SP.ClientContext,o=e.get_site(),s=o.get_userCustomActions(),f=s.add();f.set_title(n);f.set_description(t);f.set_scriptSrc(i);f.set_sequence(r);f.set_location(u);f.update();e.executeQueryAsync(function(){console.log("Custom Action added to site"+i)},function(n,t){console.log("Request failed. \nError: "+t.get_message()+"\nStackTrace: "+t.get_stackTrace())})}function onSPContextLoad(){console.log("SP Context Loaded. Starting to load other dependent files");loadScript(_csrAppContext.SiteServerRelativeUrl+"siteassets/js/jquery.min.js",onJqueryLoaded)}function onJqueryLoaded(){loadScript(_csrAppContext.SiteServerRelativeUrl+"siteassets/js/csrUtility.js",oncsrUtilityJsLoaded);_csrAppContext.CurrentUserId=_spPageContextInfo.userLoginName.toLowerCase();_csrAppContext.userDisplayName=_spPageContextInfo.userDisplayName;$(document).ready(onMasterPageLoad);loadScript(_csrAppContext.SiteServerRelativeUrl+"SiteAssets/bootstrap-4.3.1-dist/bootstrap-4.3.1-dist/js/popper.min.js",blankCallback);loadScript(_csrAppContext.SiteServerRelativeUrl+"SiteAssets/bootstrap-4.3.1-dist/bootstrap-4.3.1-dist/js/bootstrap.min.js",blankCallback)}function oncsrUtilityJsLoaded(){CSRUtility.getCurrentUserInfo(function(){_csrAppContext.IsCSRAdmin||_csrAppContext.IsDev||validateProgramListView();(_csrAppContext.IsCSRAdmin||_csrAppContext.IsDev)&&$(".csr-admin-icon").removeClass("d-none").addClass("d-block");populateProfileProperties()});loadScript(_csrAppContext.SiteServerRelativeUrl+"siteassets/js/csrProgram.min.js",oncsrProgramJsLoaded)}function oncsrProgramJsLoaded(){checkIsPage("RegisterWithdraw.aspx")&&CSRApp.renderRegisterWithdraw();(checkIsPage("HomePageDev.aspx")||checkIsPage("Home.aspx"))&&(CSRApp.renderHomeProgramDetails(),CSRApp.renderHomePageSlider(),CSRApp.renderReport(),CSRApp.renderTestimonials(4,!0));checkIsPage("NGO.aspx")&&CSRApp.renderNGOList();(checkIsPage("MarkAttendance.aspx")||checkIsPage("Attendance.aspx"))&&CSRApp.renderMarkAttendance();checkIsPage("ViewProgram.aspx")&&CSRApp.renderViewProgram();checkIsPage("MyPrograms.aspx")&&CSRApp.renderMyProgramDetails();checkIsPage("/Lists/Feedback/Feedback.aspx")&&CSRApp.renderFeedbackPage();checkIsPage("NGODetails.aspx")&&CSRApp.renderNGODetails();checkIsPage("Gallery.aspx")&&CSRApp.renderGallery();checkIsPage("Testimonies.aspx")&&CSRApp.renderTestimonials(null,!1);checkIsPage("ProgramAction.aspx")&&(loadCss("bootstrappickercss",_csrAppContext.SiteServerRelativeUrl+"SiteAssets/bootstrap-4.3.1-dist/bootstrap-datetimepicker-master/css/bootstrap-datetimepicker.min.css"),loadScript(_csrAppContext.SiteServerRelativeUrl+"SiteAssets/bootstrap-4.3.1-dist/bootstrap-datetimepicker-master/js/bootstrap-datetimepicker.min.js",function(){CSRApp.renderProgramAction()}))}function onMasterPageLoad(){}function validateProgramListView(){checkIsPage("PageNotFoundError.aspx")&&!_csrAppContext.IsCSRAdmin&&($("body").hide(),window.location=_csrAppContext.SiteServerRelativeUrl+"?pagenotfound");checkIsPage("/Lists/")&&!checkIsPage("/Lists/Feedback/Feedback.aspx")&&($("body").hide(),alert("Access Denied!"),window.location=_csrAppContext.SiteServerRelativeUrl);checkIsPage("Lists/Programs/")&&(ExecuteOrDelayUntilScriptLoaded(function(){$(".ms-acal-rootdiv td").on("mousedown mouseup dblclick mousemove",!1);$("body").on("mousedown mouseup dblclick mousemove",".ms-acal-rootdiv td",!1)},"SP.UI.ApplicationPages.Calendar.js"),$("#s4-ribbonrow").hide())}function populateProfileProperties(){$(".csr-account-name").html(CSRUtility.substring(_csrAppContext.currentUser.PrefferedName,0,15));$(".csr-account-name").attr("title",_csrAppContext.currentUser.PrefferedName);$(".csr-account-description").html(_csrAppContext.currentUser.JobTitle);$(".csr-user img").attr("src",_csrAppContext.currentUser.PictureURL)}function loadConditionalCss(){loadCss("csrStyle",_csrAppContext.SiteServerRelativeUrl+"siteassets/css/csrstyle.css")}function checkIsPage(n){return window.location.href.toLowerCase().indexOf(n.toLowerCase())>-1?!0:!1}_csrAppContext={};_csrAppContext.DebugMode=!0;_csrAppContext.SiteServerRelativeUrl="/sites/CSR/";loadConditionalCss();ExecuteOrDelayUntilBodyLoaded(function(){EnsureScriptFunc("SP.js","SP.ClientContext",onSPContextLoad)});